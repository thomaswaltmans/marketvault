{% extends "portfolio/layout.html" %}
{% load static %}

{% block body %}
  <div id="view-dashboard" class="view">
    <h2>Portfolio Dashboard</h2>
    <div id="chart-growth" style="width:100%;height:420px;"></div>
    <div id="chart-allocation" style="width:100%;height:420px;"></div>
  </div>

  <div id="view-assets" class="view">
    <h2>Assets</h2>

    <div style="margin-bottom: 1rem;">
      <input id="asset-search" placeholder="Search by ticker, name, or data symbol">
      <button id="btn-asset-search">Search</button>
      <button id="btn-asset-refresh">Refresh</button>
    </div>
  
    <h3>Create asset</h3>
    <div style="margin-bottom: 1rem;">
      <input id="asset-ticker" placeholder="Ticker (e.g. ASML)" />
      <input id="asset-name" placeholder="Name (optional)" />
      <input id="asset-exchange" placeholder="Exchange (optional, e.g. Euronext)" />
      <input id="asset-currency" placeholder="Currency (default EUR)" />
      <input id="asset-data-symbol" placeholder="Data symbol (e.g. ASML.AS)" />
      <button id="btn-asset-create">Create</button>
      <div id="asset-create-status"></div>
    </div>
  
    <h3>All assets</h3>
    <div id="assets-list"></div>
  </div>

  <div id="view-transactions" class="view">
    <h2>Transactions</h2>
    <div style="margin-bottom: 1rem;">
      <button id="btn-new-transaction">New transaction</button>
      <button id="btn-refresh-transactions">Refresh</button>
    </div>
  
    <div id="transactions-status"></div>
    <div id="transactions-list"></div>
  </div>

  <div id="view-transaction-form" class="view">
    <h2 id="transaction-form-title">New transaction</h2>

    <div style="margin-bottom: 0.75rem;">
      <label>Type</label><br>
      <select id="txn-type">
        <option value="BUY">BUY</option>
        <option value="SELL">SELL</option>
        <option value="DIV">DIV</option>
      </select>
    </div>
  
    <div style="margin-bottom: 0.75rem;">
      <label>Asset</label><br>
      <select id="txn-asset"></select>
      <div style="font-size: 0.9rem; opacity: 0.8;" id="txn-asset-hint"></div>
    </div>
  
    <div id="trade-fields">
      <div style="margin-bottom: 0.75rem;">
        <label>Quantity</label><br>
        <input id="txn-quantity" placeholder="e.g. 2 or 0.5">
      </div>
  
      <div style="margin-bottom: 0.75rem;">
        <label>Unit price</label><br>
        <input id="txn-unit-price" placeholder="e.g. 88.49">
      </div>
    </div>
  
    <div id="div-fields" style="display:none;">
      <div style="margin-bottom: 0.75rem;">
        <label>Dividend amount</label><br>
        <input id="txn-div-amount" placeholder="e.g. 12.34">
      </div>
    </div>
  
    <div style="margin-bottom: 0.75rem;">
      <label>Timestamp (optional ISO)</label><br>
      <input id="txn-timestamp" type="date" placeholder="today">
    </div>
  
    <div style="margin-top: 1rem;">
      <button id="btn-save-transaction">Save</button>
      <button id="btn-cancel-transaction">Cancel</button>
      <div id="transaction-form-status" style="margin-top:0.5rem;"></div>
    </div>
  </div>

  <div id="view-import" class="view">
    <h2>Load Portfolio from Excel File</h2>
    <div>Only .xslx files are supported. Columns should include:</div>
    <div>| data_symbol | txn_type | quantity | unit_price | div_amount | timestamp |</div>
    <br>
    <input type="file" id="xlsx" accept=".xlsx">
    <button id="btn-import">Import</button>
    <div id="import-status"></div>
  </div>
{% endblock %}

{% block script %}
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
  <script src="{% static 'portfolio/script.js' %}"></script>
{% endblock %}
